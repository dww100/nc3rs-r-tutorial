<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="David W. Wright">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Advanced Graphing I - NC3Rs R Tutorial</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Advanced Graphing I";
    var mkdocs_page_input_path = "advanced_graphing.md";
    var mkdocs_page_url = "/advanced_graphing/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> NC3Rs R Tutorial</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../intro/">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../data_from_files/">Reading data from files</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../processing_data/">Working with data</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../scripting/">Scripting</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../basic_graphing/">Basic Graphing</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Advanced Graphing I</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#advanced-graphing-with-ggplot2">Advanced graphing with ggplot2</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#obtaining-the-data">Obtaining the data</a></li>
        
            <li><a class="toctree-l3" href="#create-a-simple-plot">Create a simple plot</a></li>
        
            <li><a class="toctree-l3" href="#adding-a-trend-line">Adding a trend line</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../advanced_graphing_ii/">Advanced Graphing II</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">NC3Rs R Tutorial</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Advanced Graphing I</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/dww100/nc3rs-r-tutorial/edit/master/docs/advanced_graphing.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="advanced-graphing-with-ggplot2">Advanced graphing with ggplot2</h1>
<p>In this section we will recreate a graph from the Economist (shown below), providing a crash course in making beautiful figures with ggplot2.</p>
<p><img alt="Economist - Corruption and development graph" src="../images/economist.png" /></p>
<p>This was originally used as a challenge in the Harvard tutorial available <a href="http://tutorials.iq.harvard.edu/R/Rgraphics/Rgraphics.html">here</a>.
It is well worth checking out that tutorial to get a better understanding of the steps used here to build up the graph.</p>
<p>As we progress we will also introduce some new concepts in <em>R</em> which are useful beyond there relevance to making this graph.</p>
<h2 id="obtaining-the-data">Obtaining the data</h2>
<p>We can load the data the graph is based on directly from the tutorial website using:</p>
<pre><code>econ &lt;- read.csv(&quot;https://dww100.github.io/nc3rs-r-tutorial/data/economist.csv&quot;)
</code></pre>

<p>The data is available <a href="../data/economist.csv">here</a> to download and read from the file system if you prefer.</p>
<p>Investigate the data using either the <em>R Studio</em> data viewer or using the command:</p>
<pre><code>head(econ)
</code></pre>

<p>The two columns we are most interested in are <code>CPI</code> (Corruptions Perception Index) and <code>HDI</code> (Human Development Index).</p>
<h2 id="create-a-simple-plot">Create a simple plot</h2>
<p>To create a scatter plot of the data with <code>CPI</code> on the x-axis and <code>HDI</code> on the y-axis enter the folowing:</p>
<pre><code>&gt; ggplot(econ, aes(x = CPI, y = HDI)) +
  geom_point()
</code></pre>

<p>As in the earlier example the <code>ggplot</code> command here creates the plot object and selects the <code>CPI</code> and <code>HDI</code> columns to be the x and y variables.
<code>geom_point</code> then adds the scatter plot layer.
Your plot should look something like the one below.</p>
<p><img alt="" src="../images/economist-basic-scatter.png" /></p>
<p>This looks pretty bland and no distinction has been made between the points representing data different regions of the world.
To brighten the graph up lets color the points based on <code>Region</code> and alter the dots to hollow points (as used in the Economist graph).</p>
<pre><code>&gt;ggplot(econ, aes(x = CPI, y = HDI)) + 
  geom_point(aes(color = Region), shape = 1)
</code></pre>

<p><img alt="" src="../images/economist-colour-scatter.png" /></p>
<h2 id="adding-a-trend-line">Adding a trend line</h2>
<p>In the Economist graph a line has been added to highlight the relationship between <code>CPI</code> and <code>HDI</code> to the viewer.
The <em>geom</em> used in ggplot2 to add this trend line is <code>geom_smooth</code>.</p>
<p>In order to add a trend line, we need to have a model linking changes in <code>CPI</code> to <code>HDI</code>.
The relationship here is a logarithmic one, mathematically the formula we want to use is <code>HDI</code> = log(<code>CPI</code>).
In <em>R</em> the <code>=</code> symbol is used for assignment and <code>~</code> is used instead.</p>
<p>Replot the graph with an added trend line using:</p>
<pre><code>&gt;ggplot(econ, aes(x = CPI, y = HDI)) + 
  geom_point(aes(color = Region), shape = 1) +
  stat_smooth(method = &quot;lm&quot;, formula = y ~ log(x), se = FALSE, color = &quot;red&quot;)
</code></pre>

<p><img alt="" src="../images/economist-trend-thick.png" /></p>
<p>Compared to the circles, the trend line appears a bit too thick.
Reduce this size using the <code>size</code> option:</p>
<pre><code>&gt;ggplot(econ, aes(x = CPI, y = HDI)) + 
  geom_point(aes(color = Region), shape = 1, stroke = 1, size = 2.5) +
  stat_smooth(method = &quot;lm&quot;, formula = y ~ log(x), se = FALSE, color = &quot;red&quot;, size = 0.5)
</code></pre>

<p><img alt="" src="../images/economist-trend-thin.png" /></p>
<p>In the next part of the tutorial we will add labels to the plot and make the theme resemble the original plot.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../advanced_graphing_ii/" class="btn btn-neutral float-right" title="Advanced Graphing II">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../basic_graphing/" class="btn btn-neutral" title="Basic Graphing"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p><p>Created by David W. Wright</p> <img src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"> This work is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/"/>Creative Commons Attribution-ShareAlike 4.0 International License.</a></p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/dww100/nc3rs-r-tutorial" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../basic_graphing/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../advanced_graphing_ii/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>

</body>
</html>
